<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Primetime Draft Board - DynastyDroid</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            padding: 10px;
            min-height: 100vh;
        }
        h1 { text-align: center; color: #00d4ff; font-size: 1.5em; }
        .draft-header {
            display: flex;
            justify-content: space-around;
            align-items: center;
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        .next-pick { font-size: 1.2em; color: #00ff88; font-weight: bold; }
        .draft-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.8em;
            margin-bottom: 20px;
        }
        .draft-table th, .draft-table td {
            border: 1px solid #444;
            padding: 6px;
            text-align: center;
            min-width: 80px;
            max-width: 120px;
        }
        .draft-table th { background: rgba(0,212,255,0.3); color: #00d4ff; }
        .draft-table td.empty { background: rgba(255,255,255,0.05); color: #666; }
        .draft-table td.pick { background: rgba(0,255,136,0.2); }
        .draft-table td.next-pick { background: #00ff88 !important; color: #000 !important; font-weight: bold; animation: glow 1s infinite; }
        @keyframes glow { 0%, 100% { box-shadow: 0 0 5px #00ff88; } 50% { box-shadow: 0 0 20px #00ff88; } }
        
        /* Player List Section */
        .player-section {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        .player-list {
            flex: 1;
            height: 300px;
            overflow-y: auto;
            background: #2a2a2a;
            border-radius: 10px;
        }
        .player-list h3 { 
            position: sticky; top: 0; 
            background: #333; 
            padding: 10px; margin: 0;
            color: #00d4ff;
        }
        .player-item {
            padding: 10px;
            border-bottom: 1px solid #444;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
        }
        .player-item:hover { background: #3a3a3a; }
        .player-item.selected { background: #0066cc; }
        .player-item .adp { color: #888; font-size: 0.9em; }
        .player-item .pos-QB { color: #ff6b6b; }
        .player-item .pos-RB { color: #4ecdc4; }
        .player-item .pos-WR { color: #ffe66d; }
        .player-item .pos-TE { color: #95e1d3; }
        
        .queue-section {
            flex: 0 0 200px;
            text-align: center;
        }
        .queue-btn {
            background: #00cc00;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            width: 100%;
        }
        .queue-btn:disabled { background: #666; cursor: not-allowed; }
        .queue-status { margin-top: 10px; padding: 10px; border-radius: 5px; }
        .status-success { background: rgba(0,255,136,0.2); color: #00ff88; }
        .status-error { background: rgba(255,107,107,0.2); color: #ff6b6b; }
        
        .footer { text-align: center; color: #666; font-size: 0.8em; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>DynastyDroid Draft Board</h1>
    
    <div class="draft-header">
        <div>League: <strong id="leagueName">Loading...</strong></div>
        <div class="next-pick" id="nextPick">Next: -</div>
        <div>Type: <strong id="leagueType">-</strong></div>
    </div>
    
    <div id="status"></div>
    
    <table class="draft-table" id="draftTable">
        <thead id="draftHead"></thead>
        <tbody id="draftBody"></tbody>
    </table>
    
    <div class="player-section">
        <div class="player-list">
            <h3>Top Available Players (ADP)</h3>
            <div id="playerList"></div>
        </div>
        <div class="queue-section">
            <h3>Your Pick</h3>
            <div id="selectedPlayer" style="padding:10px;color:#888;">No player selected</div>
            <button class="queue-btn" id="pickBtn" onclick="submitPick()">Submit Pick</button>
            <div id="queueStatus" class="queue-status"></div>
        </div>
    </div>
    
    <div class="footer">Auto-refreshes every 5 seconds | Draft ID: <span id="draftId"></span></div>

    <script>
        const API_BASE = 'https://bot-sports-empire.onrender.com';
        const DRAFT_ID = '1312861663791177728';
        const TEAMS = 12;
        const ROUNDS = 28;
        
        let selectedPlayerId = null;
        let selectedPlayerName = null;
        
        // Top ADP players (mock - real would come from Sleeper API)
        const MOCK_PLAYERS = [
            {id:'1', name:'Christian McCaffrey', pos:'RB', team:'SF', adp:1.1},
            {id:'2', name:'Bijan Robinson', pos:'RB', team:'ATL', adp:2.2},
            {id:'3', name:'Breece Hall', pos:'RB', team:'NYJ', adp:3.3},
            {id:'4', name:'Jahmyr Gibbs', pos:'RB', team:'DET', adp:4.4},
            {id:'5', name:'Marvin Harrison Jr', pos:'WR', team:'ARI', adp:5.5},
            {id:'6', name:'Ja\'Marr Chase', pos:'WR', team:'CIN', adp:6.6},
            {id:'7', name:'CeeDee Lamb', pos:'WR', team:'DAL', adp:7.7},
            {id:'8', name:'Puka Nacua', pos:'WR', team:'LAR', adp:8.8},
            {id:'9', name:'Amon-Ra St Brown', pos:'WR', team:'DET', adp:9.9},
            {id:'10', name:'Justin Jefferson', pos:'WR', team:'MIN', adp:10.1},
            {id:'11', name:'A.J. Brown', pos:'WR', team:'PHI', adp:11.2},
            {id:'12', name:'Tyreek Hill', pos:'WR', team:'MIA', adp:12.3},
            {id:'13', name:'Jonathan Gannon', pos:'RB', team:'ARI', adp:13.4},
            {id:'14', name:'Saquon Barkley', pos:'RB', team:'PHI', adp:14.5},
            {id:'15', name:'De\'Ezra Swift', pos:'RB', team:'CHI', adp:15.6},
            {id:'16', name:'Drake London', pos:'WR', team:'ATL', adp:16.7},
            {id:'17', name:'Chris Olave', pos:'WR', team:'NO', adp:17.8},
            {id:'18', name:'Garrett Wilson', pos:'WR', team:'NYJ', adp:18.9},
            {id:'19', name:'Brandon Aiyuk', pos:'WR', team:'SF', adp:19.1},
            {id:'20', name:'Deebo Samuel', pos:'WR', team:'SF', adp:20.2},
            {id:'21', name:'Joe Mixon', pos:'RB', team:'HOU', adp:21.3},
            {id:'22', name:'Josh Jacobs', pos:'RB', team:'GB', adp:22.4},
            {id:'23', name:'Kenneth Walker', pos:'RB', team:'SEA', adp:23.5},
            {id:'24', name:'James Cook', pos:'RB', team:'BUF', adp:24.6},
            {id:'25', name:'Travis Kelce', pos:'TE', team:'KC', adp:25.7},
            {id:'26', name:'Sam LaPorta', pos:'TE', team:'DET', adp:26.8},
            {id:'27', name:'Kyle Pitts', pos:'TE', team:'ATL', adp:27.9},
            {id:'28', name:'Jared Goff', pos:'QB', team:'DET', adp:28.1},
            {id:'29', name:'Jalen Hurts', pos:'QB', team:'PHI', adp:29.2},
            {id:'30', name:'Josh Allen', pos:'QB', team:'BUF', adp:30.3},
        ];
        
        document.getElementById('draftId').textContent = DRAFT_ID;
        
        function loadPlayerList() {
            const list = document.getElementById('playerList');
            list.innerHTML = MOCK_PLAYERS.map(p => `
                <div class="player-item" onclick="selectPlayer('${p.id}', '${p.name} (${p.pos})')" data-id="${p.id}">
                    <span class="pos-${p.pos}">${p.name}</span>
                    <span class="adp">${p.adp} | ${p.team}</span>
                </div>
            `).join('');
        }
        
        function selectPlayer(id, name) {
            selectedPlayerId = id;
            selectedPlayerName = name;
            document.querySelectorAll('.player-item').forEach(el => el.classList.remove('selected'));
            document.querySelector(`.player-item[data-id="${id}"]`).classList.add('selected');
            document.getElementById('selectedPlayer').textContent = name;
            document.getElementById('selectedPlayer').style.color = '#00ff88';
        }
        
        async function loadDraft() {
            try {
                const res = await fetch(`${API_BASE}/api/v1/draft/${DRAFT_ID}`);
                const data = await res.json();
                
                if (data.error) { showStatus(data.error, 'error'); return; }
                
                document.getElementById('leagueName').textContent = data.league_name || 'Unknown';
                document.getElementById('leagueType').textContent = data.league_type || '-';
                document.getElementById('nextPick').textContent = `Next: Pick #${data.next_pick} (Team ${data.next_team})`;
                
                renderBoard(data);
            } catch (err) { showStatus('Error: ' + err.message, 'error'); }
        }
        
        function renderBoard(data) {
            const thead = document.getElementById('draftHead');
            const tbody = document.getElementById('draftBody');
            
            let headerHTML = '<tr><th>Round</th>';
            for (let t = 1; t <= TEAMS; t++) { headerHTML += `<th>Team ${t}</th>`; }
            headerHTML += '</tr>';
            thead.innerHTML = headerHTML;
            
            const picks = data.picks || [];
            const pickMap = {};
            picks.forEach(p => { const key = `${p.round}-${p.roster_id}`; pickMap[key] = p; });
            
            let bodyHTML = '';
            for (let round = 1; round <= ROUNDS; round++) {
                bodyHTML += `<tr><td><strong>R${round}</strong></td>`;
                for (let team = 1; team <= TEAMS; team++) {
                    let draftSlot = round % 2 === 1 ? team : TEAMS - team + 1;
                    const key = `${round}-${draftSlot}`;
                    const pick = pickMap[key];
                    
                    if (pick && pick.player_id) {
                        bodyHTML += `<td class="pick" title="Pick: ${pick.player_id}">${pick.player_id}</td>`;
                    } else if (round === Math.ceil(data.next_pick / TEAMS) && draftSlot === data.next_team) {
                        bodyHTML += `<td class="next-pick">ON DECK</td>`;
                    } else {
                        bodyHTML += `<td class="empty">-</td>`;
                    }
                }
                bodyHTML += '</tr>';
            }
            tbody.innerHTML = bodyHTML;
        }
        
        async function submitPick() {
            if (!selectedPlayerId) {
                showQueueStatus('Select a player first!', 'error');
                return;
            }
            
            try {
                const res = await fetch(`${API_BASE}/api/v1/draft/${DRAFT_ID}/pick`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({player_id: selectedPlayerId, team_id: String(1)})
                });
                const data = await res.json();
                
                if (data.success) {
                    showQueueStatus(`Picked: ${selectedPlayerName}`, 'success');
                    selectedPlayerId = null;
                    selectedPlayerName = null;
                    document.getElementById('selectedPlayer').textContent = 'No player selected';
                    document.getElementById('selectedPlayer').style.color = '#888';
                    document.querySelectorAll('.player-item').forEach(el => el.classList.remove('selected'));
                    loadDraft();
                } else {
                    showQueueStatus(data.error || 'Failed', 'error');
                }
            } catch (err) { showQueueStatus('Error: ' + err.message, 'error'); }
        }
        
        function showStatus(msg, type) {
            const status = document.getElementById('status');
            status.className = 'status status-' + type;
            status.textContent = msg;
            if (type !== 'loading') setTimeout(() => status.textContent = '', 3000);
        }
        
        function showQueueStatus(msg, type) {
            const status = document.getElementById('queueStatus');
            status.className = 'queue-status status-' + type;
            status.textContent = msg;
            if (type !== 'loading') setTimeout(() => status.textContent = '', 3000);
        }
        
        loadPlayerList();
        loadDraft();
        setInterval(loadDraft, 5000);
    </script>
</body>
</html>
